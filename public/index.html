<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.12.1/datatables.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.12.1/datatables.min.css" />

    <title>Multiple Transaction Manager Example</title>

</head>

<body class="d-flex justify-content-center">
    <div style="max-width:1000px; text-align:center;align-content:center;">
        <br>
        <h2>Multiple Transaction Manager Example</h2>
        <div class="container">
            <div class="row">
                <div class="col-xs-12 col-md-4">
                    <form action="#" class="bordered">
                        <div class="mb-3 mt-3">
                            <h3>Register User</h3>
                        </div>
                        <div class="mb-3">
                            <label for="name" class="form-label">Name:</label>
                            <input type="text" class="form-control" id="name" placeholder="Enter name" name="name">
                        </div>
                        <div class="mb-3">
                            <label for="surname" class="form-label">Surname:</label>
                            <input type="text" class="form-control" id="name" placeholder="Enter surname"
                                name="surname">
                        </div>
                        <div class="mb-3 mt-3">
                            <label for="email" class="form-label">Email:</label>
                            <input type="email" class="form-control" id="email" placeholder="Enter email" name="email">
                        </div>
                        <button type="submit" class="btn btn-primary">Register</button>
                    </form>
                </div>
                <div class="col-xs-12 col-md-8">
                    <div class="bordered">
                        <h3>Users</h3>
                        <table id="users">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Surname</th>
                                    <th>Email</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

<script>

    const usersTable = $('#users').DataTable({
        ajax: {
            url: '/users',
            dataSrc: '',
        },
        columns: [
            { data: 'name' },
            { data: 'surname' },
            { data: 'email' },
        ],
        paging: false,
        searching: false,
        info: false
    });

    $("button[type='submit']").on("click", (event) => {
        var formData = JSON.stringify($(event.currentTarget).parent().serializeArray());
        $.ajax({
            type: "POST",
            url: "/users/create",
            data: formData,
            success: (data) => { usersTable.clear().rows.add(data).draw(); },
            error: (err) => { alert("Error occurred: " + err.responseJSON["error"]); },
            dataType: "json",
            contentType: "application/json"
        });
        return false;
    });

</script>
<style>
    .bordered {
        border-color: rgba(126, 239, 104, 0.8);
        box-shadow: 0 1px 1px rgba(0, 0, 0, 0.075) inset, 0 0 8px rgba(126, 126, 126, 0.6);
        outline: 0 none;
        padding: 10px;
        text-align: left;
        align-content: left;
    }
</style>

</html>